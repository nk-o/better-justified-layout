"use strict";const t=function(t){this.index=t.index,this.top=t.top,this.left=t.left,this.width=t.width,this.spacing=t.spacing,this.targetRowHeight=t.targetRowHeight,this.targetRowHeightTolerance=t.targetRowHeightTolerance,this.minAspectRatio=this.width/t.targetRowHeight*(1-t.targetRowHeightTolerance),this.maxAspectRatio=this.width/t.targetRowHeight*(1+t.targetRowHeightTolerance),this.edgeCaseMinRowHeight=t.edgeCaseMinRowHeight,this.edgeCaseMaxRowHeight=t.edgeCaseMaxRowHeight,this.widowLayoutStyle=t.widowLayoutStyle,this.isBreakoutRow=t.isBreakoutRow,this.items=[],this.height=0};
/*!
 * Copyright 2019 SmugMug, Inc. | Copyright 2024 nK
 * Licensed under the terms of the MIT license. Please see LICENSE file in the project root for terms.
 * @license
 */
function e(e,i){let o;return!1!==e.fullWidthBreakoutRowCadence&&(i._rows.length+1)%e.fullWidthBreakoutRowCadence==0&&(o=!0),new t({index:i._rows.length,top:i._containerHeight,left:e.containerPadding.left,width:e.containerWidth-e.containerPadding.left-e.containerPadding.right,spacing:e.boxSpacing.horizontal,targetRowHeight:e.targetRowHeight,targetRowHeightTolerance:e.targetRowHeightTolerance,edgeCaseMinRowHeight:e.edgeCaseMinRowHeight*e.targetRowHeight,edgeCaseMaxRowHeight:e.edgeCaseMaxRowHeight*e.targetRowHeight,rightToLeft:!1,isBreakoutRow:o,widowLayoutStyle:e.widowLayoutStyle})}function i(t,e,i){return e._rows.push(i),e._layoutItems=e._layoutItems.concat(i.getItems()),e._containerHeight+=i.height+t.boxSpacing.vertical,i.items}t.prototype={addItem:function(t){const e=this.items.concat(t),i=this.width-(e.length-1)*this.spacing,o=e.reduce((function(t,e){return t+e.aspectRatio}),0),a=i/this.targetRowHeight;let n,s,h;return this.isBreakoutRow&&0===this.items.length&&t.aspectRatio>=1?(this.items.push(t),this.completeLayout(i/t.aspectRatio,"justify"),!0):o<this.minAspectRatio?(this.items.push(Object.assign({},t)),!0):o>this.maxAspectRatio?0===this.items.length?(this.items.push(Object.assign({},t)),this.completeLayout(i/o,"justify"),!0):(n=this.width-(this.items.length-1)*this.spacing,s=this.items.reduce((function(t,e){return t+e.aspectRatio}),0),h=n/this.targetRowHeight,Math.abs(o-a)>Math.abs(s-h)?(this.completeLayout(n/s,"justify"),!1):(this.items.push(Object.assign({},t)),this.completeLayout(i/o,"justify"),!0)):(this.items.push(Object.assign({},t)),this.completeLayout(i/o,"justify"),!0)},isLayoutComplete:function(){return this.height>0},completeLayout:function(t,e){let i=this.left;const o=this.width-(this.items.length-1)*this.spacing;let a,n,s,h,r,g;(void 0===e||["justify","center","left"].indexOf(e)<0)&&(e="left"),n=Math.max(this.edgeCaseMinRowHeight,Math.min(t,this.edgeCaseMaxRowHeight)),t!==n?(this.height=n,a=o/n/(o/t)):(this.height=t,a=1),this.items.forEach((function(t){t.row=this.index,t.top=this.top,t.width=t.aspectRatio*this.height*a,t.height=this.height,t.left=i,i+=t.width+this.spacing}),this),"justify"===e?(i-=this.spacing+this.left,s=(i-this.width)/this.items.length,h=this.items.map((function(t,e){return Math.round((e+1)*s)})),1===this.items.length?(r=this.items[0],r.width-=Math.round(s)):this.items.forEach((function(t,e){e>0?(t.left-=h[e-1],t.width-=h[e]-h[e-1]):t.width-=h[e]}))):"center"===e&&(g=(this.width-i)/2,this.items.forEach((function(t){t.left+=g+this.spacing}),this))},forceComplete:function(t,e){"number"==typeof e?this.completeLayout(e,this.widowLayoutStyle):this.completeLayout(this.targetRowHeight,this.widowLayoutStyle)},getItems:function(){return this.items}},module.exports=function(t,o){let a={};const n={},s={containerWidth:1060,containerPadding:10,boxSpacing:10,targetRowHeight:320,targetRowHeightTolerance:.25,edgeCaseMinRowHeight:.5,edgeCaseMaxRowHeight:2.5,maxNumRows:Number.POSITIVE_INFINITY,forceAspectRatio:!1,showWidows:!0,fullWidthBreakoutRowCadence:!1,widowLayoutStyle:"left"},h={},r={};return o=o||{},a=Object.assign(s,o),h.top=isNaN(parseFloat(a.containerPadding.top))?a.containerPadding:a.containerPadding.top,h.right=isNaN(parseFloat(a.containerPadding.right))?a.containerPadding:a.containerPadding.right,h.bottom=isNaN(parseFloat(a.containerPadding.bottom))?a.containerPadding:a.containerPadding.bottom,h.left=isNaN(parseFloat(a.containerPadding.left))?a.containerPadding:a.containerPadding.left,r.horizontal=isNaN(parseFloat(a.boxSpacing.horizontal))?a.boxSpacing:a.boxSpacing.horizontal,r.vertical=isNaN(parseFloat(a.boxSpacing.vertical))?a.boxSpacing:a.boxSpacing.vertical,a.containerPadding=h,a.boxSpacing=r,n._layoutItems=[],n._awakeItems=[],n._inViewportItems=[],n._leadingOrphans=[],n._trailingOrphans=[],n._containerHeight=a.containerPadding.top,n._rows=[],n._orphans=[],a._widowCount=0,function(t,o,a){let n,s,h,r=[];return t.forceAspectRatio&&a.forEach((function(e){e.forcedAspectRatio=!0,e.aspectRatio=t.forceAspectRatio})),a.some((function(a,h){if(isNaN(a.aspectRatio))throw new Error("Item "+h+" has an invalid aspect ratio");if(s||(s=e(t,o)),n=s.addItem(a),s.isLayoutComplete()){if(r=r.concat(i(t,o,s)),o._rows.length>=t.maxNumRows)return s=null,!0;if(s=e(t,o),!n&&(n=s.addItem(a),s.isLayoutComplete())){if(r=r.concat(i(t,o,s)),o._rows.length>=t.maxNumRows)return s=null,!0;s=e(t,o)}}})),s&&s.getItems().length&&t.showWidows&&(o._rows.length?(h=o._rows[o._rows.length-1].isBreakoutRow?o._rows[o._rows.length-1].targetRowHeight:o._rows[o._rows.length-1].height,s.forceComplete(!1,h)):s.forceComplete(!1),r=r.concat(i(t,o,s)),t._widowCount=s.getItems().length),o._containerHeight=o._containerHeight-t.boxSpacing.vertical,o._containerHeight=o._containerHeight+t.containerPadding.bottom,{containerHeight:o._containerHeight,widowCount:t._widowCount,boxes:o._layoutItems}}(a,n,t.map((function(t){return t.width&&t.height?{aspectRatio:t.width/t.height}:{aspectRatio:t}})))};
//# sourceMappingURL=better-justified-layout.min.js.map
