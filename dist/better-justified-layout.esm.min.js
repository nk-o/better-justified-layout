const t=function(t){this.top=t.top,this.left=t.left,this.width=t.width,this.spacing=t.spacing,this.targetRowHeight=t.targetRowHeight,this.targetRowHeightTolerance=t.targetRowHeightTolerance,this.minAspectRatio=this.width/t.targetRowHeight*(1-t.targetRowHeightTolerance),this.maxAspectRatio=this.width/t.targetRowHeight*(1+t.targetRowHeightTolerance),this.edgeCaseMinRowHeight=t.edgeCaseMinRowHeight,this.edgeCaseMaxRowHeight=t.edgeCaseMaxRowHeight,this.widowLayoutStyle=t.widowLayoutStyle,this.isBreakoutRow=t.isBreakoutRow,this.items=[],this.height=0};
/*!
 * Copyright 2019 SmugMug, Inc. | Copyright 2024 nK
 * Licensed under the terms of the MIT license. Please see LICENSE file in the project root for terms.
 * @license
 */
function i(i,e){let o;return!1!==i.fullWidthBreakoutRowCadence&&(e._rows.length+1)%i.fullWidthBreakoutRowCadence==0&&(o=!0),new t({top:e._containerHeight,left:i.containerPadding.left,width:i.containerWidth-i.containerPadding.left-i.containerPadding.right,spacing:i.boxSpacing.horizontal,targetRowHeight:i.targetRowHeight,targetRowHeightTolerance:i.targetRowHeightTolerance,edgeCaseMinRowHeight:.5*i.targetRowHeight,edgeCaseMaxRowHeight:2*i.targetRowHeight,rightToLeft:!1,isBreakoutRow:o,widowLayoutStyle:i.widowLayoutStyle})}function e(t,i,e){return i._rows.push(e),i._layoutItems=i._layoutItems.concat(e.getItems()),i._containerHeight+=e.height+t.boxSpacing.vertical,e.items}function o(t,o){let a={};const n={},s={containerWidth:1060,containerPadding:10,boxSpacing:10,targetRowHeight:320,targetRowHeightTolerance:.25,maxNumRows:Number.POSITIVE_INFINITY,forceAspectRatio:!1,showWidows:!0,fullWidthBreakoutRowCadence:!1,widowLayoutStyle:"left"},h={},r={};return o=o||{},a=Object.assign(s,o),h.top=isNaN(parseFloat(a.containerPadding.top))?a.containerPadding:a.containerPadding.top,h.right=isNaN(parseFloat(a.containerPadding.right))?a.containerPadding:a.containerPadding.right,h.bottom=isNaN(parseFloat(a.containerPadding.bottom))?a.containerPadding:a.containerPadding.bottom,h.left=isNaN(parseFloat(a.containerPadding.left))?a.containerPadding:a.containerPadding.left,r.horizontal=isNaN(parseFloat(a.boxSpacing.horizontal))?a.boxSpacing:a.boxSpacing.horizontal,r.vertical=isNaN(parseFloat(a.boxSpacing.vertical))?a.boxSpacing:a.boxSpacing.vertical,a.containerPadding=h,a.boxSpacing=r,n._layoutItems=[],n._awakeItems=[],n._inViewportItems=[],n._leadingOrphans=[],n._trailingOrphans=[],n._containerHeight=a.containerPadding.top,n._rows=[],n._orphans=[],a._widowCount=0,function(t,o,a){let n,s,h,r=[];return t.forceAspectRatio&&a.forEach((function(i){i.forcedAspectRatio=!0,i.aspectRatio=t.forceAspectRatio})),a.some((function(a,h){if(isNaN(a.aspectRatio))throw new Error("Item "+h+" has an invalid aspect ratio");if(s||(s=i(t,o)),n=s.addItem(a),s.isLayoutComplete()){if(r=r.concat(e(t,o,s)),o._rows.length>=t.maxNumRows)return s=null,!0;if(s=i(t,o),!n&&(n=s.addItem(a),s.isLayoutComplete())){if(r=r.concat(e(t,o,s)),o._rows.length>=t.maxNumRows)return s=null,!0;s=i(t,o)}}})),s&&s.getItems().length&&t.showWidows&&(o._rows.length?(h=o._rows[o._rows.length-1].isBreakoutRow?o._rows[o._rows.length-1].targetRowHeight:o._rows[o._rows.length-1].height,s.forceComplete(!1,h)):s.forceComplete(!1),r=r.concat(e(t,o,s)),t._widowCount=s.getItems().length),o._containerHeight=o._containerHeight-t.boxSpacing.vertical,o._containerHeight=o._containerHeight+t.containerPadding.bottom,{containerHeight:o._containerHeight,widowCount:t._widowCount,boxes:o._layoutItems}}(a,n,t.map((function(t){return t.width&&t.height?{aspectRatio:t.width/t.height}:{aspectRatio:t}})))}t.prototype={addItem:function(t){const i=this.items.concat(t),e=this.width-(i.length-1)*this.spacing,o=i.reduce((function(t,i){return t+i.aspectRatio}),0),a=e/this.targetRowHeight;let n,s,h;return this.isBreakoutRow&&0===this.items.length&&t.aspectRatio>=1?(this.items.push(t),this.completeLayout(e/t.aspectRatio,"justify"),!0):o<this.minAspectRatio?(this.items.push(Object.assign({},t)),!0):o>this.maxAspectRatio?0===this.items.length?(this.items.push(Object.assign({},t)),this.completeLayout(e/o,"justify"),!0):(n=this.width-(this.items.length-1)*this.spacing,s=this.items.reduce((function(t,i){return t+i.aspectRatio}),0),h=n/this.targetRowHeight,Math.abs(o-a)>Math.abs(s-h)?(this.completeLayout(n/s,"justify"),!1):(this.items.push(Object.assign({},t)),this.completeLayout(e/o,"justify"),!0)):(this.items.push(Object.assign({},t)),this.completeLayout(e/o,"justify"),!0)},isLayoutComplete:function(){return this.height>0},completeLayout:function(t,i){let e=this.left;const o=this.width-(this.items.length-1)*this.spacing;let a,n,s,h,r,g;(void 0===i||["justify","center","left"].indexOf(i)<0)&&(i="left"),n=Math.max(this.edgeCaseMinRowHeight,Math.min(t,this.edgeCaseMaxRowHeight)),t!==n?(this.height=n,a=o/n/(o/t)):(this.height=t,a=1),this.items.forEach((function(t){t.top=this.top,t.width=t.aspectRatio*this.height*a,t.height=this.height,t.left=e,e+=t.width+this.spacing}),this),"justify"===i?(e-=this.spacing+this.left,s=(e-this.width)/this.items.length,h=this.items.map((function(t,i){return Math.round((i+1)*s)})),1===this.items.length?(r=this.items[0],r.width-=Math.round(s)):this.items.forEach((function(t,i){i>0?(t.left-=h[i-1],t.width-=h[i]-h[i-1]):t.width-=h[i]}))):"center"===i&&(g=(this.width-e)/2,this.items.forEach((function(t){t.left+=g+this.spacing}),this))},forceComplete:function(t,i){"number"==typeof i?this.completeLayout(i,this.widowLayoutStyle):this.completeLayout(this.targetRowHeight,this.widowLayoutStyle)},getItems:function(){return this.items}};export{o as default};
//# sourceMappingURL=better-justified-layout.esm.min.js.map
